
using System.ComponentModel.DataAnnotations;
using System.ComponentModel.DataAnnotations.Schema;

namespace Models
{
    public class BEG_CHQ_REMESSA
    {

        [NotMapped]
        public string Trigger_BEG_TRG_REM_CHQ { get; set; } = `{"triggering_event":"INSERT","trigger_body":"BEGIN\n  :new.docstatus := 'IP';\n  INSERT INTO BEG_CHQ_REMESSA_CHEQUE\n  (\n    BEG_CHQ_REMESSA_CHEQUE_ID,\n    AD_CLIENT_ID,\n    AD_ORG_ID,\n    ISACTIVE,\n    CREATED,\n    CREATEDBY,\n    UPDATED,\n    UPDATEDBY,\n    BEG_CHQ_CHEQUE_ID,\n    NOME,\n    VALOR,\n    BEG_CHQ_REMESSA_ID\n  )\n  (\n    select beg_fnc_ad_sequence('BEG_CHQ_REMESSA_CHEQUE'),\n           :NEW.AD_CLIENT_ID,\n           :NEW.AD_ORG_ID,\n           'Y',\n           sysdate,\n           :new.createdby,\n           sysdate,\n           :new.updatedby,\n           beg_chq_cheque_id,\n           nome,\n           valor,\n           :new.beg_chq_remessa_id\n    from   beg_chq_cheque c\n    where  c.ad_client_id = :new.ad_client_id\n    AND    c.ad_org_id = :NEW.ad_org_id\n    and    c.beg_fin_caixa_id = :new.beg_vw_fin_caixa_origem_id\n    and    c.data_vencimento between :new.dt_vcto_inicial and nvl(:new.dt_vcto_final,trunc(sysdate))\n  );\n--  commit;\nEND;\n"}`;
    
        [NotMapped]
        public string Trigger_BEG_TRG_BU_STATUS_REM { get; set; } = `{"triggering_event":"UPDATE","trigger_body":"declare\n  CURSOR BUSCA_CHEQUES IS \n    SELECT * \n    FROM   BEG_CHQ_REMESSA_CHEQUE\n    WHERE  BEG_CHQ_REMESSA_ID =:NEW.BEG_CHQ_REMESSA_ID;\n  --\n  V_CHEQUES_REMETIDOS BUSCA_CHEQUES%ROWTYPE;\n  --\n  CURSOR BUSCA_CAIXA_DEST IS \n    SELECT c.name\n    FROM   BEG_FIN_CAIXA C\n    WHERE  C.BEG_FIN_CAIXA_ID = :NEW.BEG_VW_FIN_CAIXA_ORIGEM_ID;\n  --\n  v_caixa_destino   busca_caixa_dest%rowtype;\n  --\n  CURSOR BUSCA_CONTA_DESTINO IS \n    SELECT b.value||' - '||a.value||' - '||conta_corrente dest\n    FROM   BEG_FIN_conta_corrente cc,\n           beg_banco b,\n           beg_agencia A\n    WHERE  cc.beg_fin_conta_corrente_id = :NEW.beg_fin_conta_corrente_id\n    AND    b.beg_banco_id = cc.beg_banco_id\n    AND    A.beg_agencia_id = cc.beg_agencia_id;\n  --\n  v_banco_destino    busca_conta_destino%rowtype;\n  --\n  v_destino VARCHAR2(1000);\n  --\n  CURSOR VALIDA_SALDO (p_beg_fin_caixa_id number ) IS \n    SELECT * \n    FROM   BEG_FIN_CAIXA_SALDO S\n    WHERE  S.beg_fin_caixa_id = p_beg_fin_caixa_id\n    AND    s.DATA = :NEW.data_realizada;\n  --\n  v_saldo            valida_saldo%rowtype;\n  v_saldo_id         NUMBER(10);\n  v_saldo_origem_id  NUMBER(10);\n  --\n  CURSOR VALIDA_SALDO_bco IS \n    SELECT * \n    FROM   beg_fin_bco_saldo S\n    WHERE  S.BEG_FIN_CONTA_CORRENTE_ID = :new.beg_fin_conta_corrente_id\n    AND    s.dt_saldo = :NEW.data_realizada;\n  --\n  v_saldo_bco   valida_saldo_bco%rowtype;\n  --\n  v_saldo_bco_id     NUMBER(10);\n  --\n  CURSOR BUSCA_DADOS_CONTA IS \n    SELECT *\n    FROM   BEG_FIN_CONTA_CORRENTE C\n    WHERE  C.BEG_FIN_CONTA_CORRENTE_ID = :NEW.BEG_FIN_CONTA_CORRENTE_ID;\n  --\n  V_CONTA  BUSCA_DADOS_CONTA%ROWTYPE;\n  --\nBEGIN\n  IF NVL(:NEW.DOCSTATUS,'IP') = 'AP' THEN\n    IF :NEW.beg_fin_caixa_id IS NOT NULL THEN \n      OPEN busca_caixa_dest;\n      fetch busca_caixa_dest INTO v_caixa_destino;\n      CLOSE busca_caixa_dest;\n      v_destino := v_caixa_destino.NAME;\n    elsif :NEW.beg_fin_conta_corrente_id IS NOT NULL then\n      OPEN busca_conta_destino;\n      fetch busca_conta_destino INTO v_banco_destino;\n      CLOSE busca_conta_destino;\n      v_destino := v_banco_destino.dest;\n    END IF;\n    IF :NEW.beg_fin_conta_corrente_id IS NOT NULL THEN \n      OPEN valida_saldo_bco;\n      fetch valida_saldo_bco INTO v_saldo_bco;\n      IF valida_saldo_bco%notfound THEN \n        OPEN BUSCA_DADOS_CONTA;\n        FETCH BUSCA_DADOS_CONTA INTO V_CONTA;\n        CLOSE BUSCA_DADOS_CONTA;\n        v_saldo_bco_ID := beg_fnc_ad_sequence('BEG_FIN_BCO_SALDO');\n        INSERT INTO BEG_FIN_BCO_SALDO\n                    ( BEG_FIN_BCO_SALDO_ID,\n                      AD_CLIENT_ID,\n                      AD_ORG_ID,\n                      ISACTIVE,\n                      CREATED,\n                      CREATEDBY,\n                      UPDATED,\n                      UPDATEDBY,\n                      DT_SALDO,\n                      SALDO_DIA_ANTERIOR,\n                      TOTAL_DEBITOS,\n                      TOTAL_CREDITOS,\n                      SALDO_DIA,\n                      BEG_BANCO_ID,\n                      BEG_AGENCIA_ID,\n                      BEG_FIN_CONTA_CORRENTE_ID,\n                      DOCSTATUS\n                    )\n                    VALUES\n                    (\n                      V_SALDO_BCO_ID,\n                      :NEW.AD_CLIENT_ID,\n                      :NEW.AD_ORG_ID,\n                      'Y',\n                      SYSDATE,\n                      :NEW.CREATEDBY,\n                      SYSDATE,\n                      :NEW.UPDATEDBY,\n                      :NEW.DATA_REALIZADA,\n                      0,\n                      0,\n                      0,\n                      0,\n                      V_CONTA.BEG_BANCO_ID,\n                      V_CONTA.BEG_AGENCIA_ID,\n                      V_CONTA.BEG_FIN_CONTA_CORRENTE_ID,\n                      'IP'\n                    );\n\n      END IF;\n      close valida_saldo_bco;\n    end if;\n    if :new.beg_fin_caixa_id is not null then\n      OPEN valida_saldo(:new.beg_fin_caixa_id);\n      fetch valida_saldo INTO v_saldo;\n      IF valida_saldo%notfound THEN\n        v_saldo_id := beg_fnc_ad_sequence('BEG_FIN_CAIXA_SALDO');\n        INSERT INTO BEG_FIN_CAIXA_SALDO\n                  ( BEG_FIN_CAIXA_SALDO_ID,\n                    AD_CLIENT_ID,\n                    AD_ORG_ID,\n                    ISACTIVE,\n                    CREATED,\n                    CREATEDBY,\n                    UPDATED,\n                    UPDATEDBY,\n                    DATA,\n                    SALDO_REALIZADO,\n                    SALDO_PREVISTO,\n                    BEG_FIN_CAIXA_ID,\n                    DOCSTATUS,\n                    TOTAL_ENTRADAS,\n                    TOTAL_SAIDAS,\n                    SALDO_ANTERIOR,\n                    DATA_MOV,\n                    NRO_CAIXA)\n                  VALUES\n                  ( V_SALDo_ID,\n                    :NEW.AD_CLIENT_ID,\n                    :NEW.AD_ORG_ID,\n                    'Y',\n                    :NEW.CREATED,\n                    :NEW.CREATEDBY,\n                    :NEW.UPDATED,\n                    :NEW.UPDATEDBY,\n                    :NEW.DATA_REALIZADA,\n                    0,\n                    0,\n                    :NEW.BEG_FIN_CAIXA_ID,\n                    'IP',\n                    0,\n                    0,\n                    0,\n                    :NEW.DATA_REALIZADA,\n                    NULL);\n      ELSE\n        v_saldo_id := v_saldo.beg_fin_caixa_saldo_id;\n      END IF;\n      CLOSE valida_saldo;\n    end if;\n    OPEN valida_saldo(:new.beg_vw_fin_caixa_origem_id);\n    fetch valida_saldo INTO v_saldo;\n    IF valida_saldo%notfound THEN\n      v_saldo_origem_id := beg_fnc_ad_sequence('BEG_FIN_CAIXA_SALDO');\n      INSERT INTO BEG_FIN_CAIXA_SALDO\n                ( BEG_FIN_CAIXA_SALDO_ID,\n                  AD_CLIENT_ID,\n                  AD_ORG_ID,\n                  ISACTIVE,\n                  CREATED,\n                  CREATEDBY,\n                  UPDATED,\n                  UPDATEDBY,\n                  DATA,\n                  SALDO_REALIZADO,\n                  SALDO_PREVISTO,\n                  BEG_FIN_CAIXA_ID,\n                  DOCSTATUS,\n                  TOTAL_ENTRADAS,\n                  TOTAL_SAIDAS,\n                  SALDO_ANTERIOR,\n                  DATA_MOV,\n                  NRO_CAIXA)\n                VALUES\n                ( V_SALDo_origem_ID,\n                  :NEW.AD_CLIENT_ID,\n                  :NEW.AD_ORG_ID,\n                  'Y',\n                  :NEW.CREATED,\n                  :NEW.CREATEDBY,\n                  :NEW.UPDATED,\n                  :NEW.UPDATEDBY,\n                  :NEW.DATA_REALIZADA,\n                  0,\n                  0,\n                  :NEW.beg_vw_fin_caixa_origem_id,\n                  'IP',\n                  0,\n                  0,\n                  0,\n                  :NEW.DATA_REALIZADA,\n                  NULL);\n    ELSE\n      v_saldo_origem_id := v_saldo.beg_fin_caixa_saldo_id;\n    END IF;\n    CLOSE valida_saldo;\n\n    OPEN BUSCA_CHEQUES;\n    LOOP\n      FETCH BUSCA_CHEQUES INTO V_CHEQUES_REMETIDOS;\n      EXIT WHEN BUSCA_CHEQUES%NOTFOUND;\n      INSERT INTO BEG_CHQ_HISTORICO\n      (\n        BEG_CHQ_HISTORICO_ID,\n        AD_CLIENT_ID,\n        AD_ORG_ID,\n        ISACTIVE,\n        CREATED,\n        CREATEDBY,\n        UPDATED,\n        UPDATEDBY,\n        DATA,\n        DESCRICAO,\n        BEG_CHQ_CHEQUE_ID,\n        BEG_FIN_CAIXA_ID,\n        BEG_FIN_CONTA_CORRENTE_ID,\n        DT_EMI_ENT,\n        DT_SAI_COMP\n      )\n      VALUES\n      (\n        BEG_FNC_AD_SEQUENCE('BEG_CHQ_HISTORICO'),\n        :NEW.AD_CLIENT_ID,\n        :NEW.AD_ORG_ID,\n        :NEW.ISACTIVE,\n        :NEW.CREATED,\n        :NEW.CREATEDBY,\n        :NEW.UPDATED,\n        :NEW.UPDATEDBY,\n        SYSDATE,\n        'ENVIADO DE  '||v_destino,\n        v_cheques_remetidos.BEG_CHQ_CHEQUE_ID,\n        :new.beg_fin_caixa_id,\n        :new.beg_fin_conta_corrente_id,\n        sysdate,\n        null\n      );\n    INSERT INTO BEG_FIN_CAIXA_MOVIMENTO\n  ( BEG_FIN_CAIXA_MOVIMENTO_ID,\n    BEG_FIN_CAIXA_ID,\n    AD_CLIENT_ID,\n    AD_ORG_ID,\n    ISACTIVE,\n    CREATED,\n    CREATEDBY,\n    UPDATED,\n    UPDATEDBY,\n    TP_LANCTO,\n    TP_MOVTO,\n    BEG_PESSOA_ID,\n    BEG_FIN_CAIXA_HISTORICO_ID,\n    BEG_FIN_CAIXA_CONTA_ID,\n    BEG_FILIAL_ID,\n    HISTORICO,\n    BEG_CRC_TITULO_ID,\n    BEG_CPG_TITULO_ID,\n    DATA_PREVISTA,\n    DATA_REALIZADA,\n    VLR_MOVIMENTO,\n    VLR_BAIXA,\n    VLR_JUROS,\n    VLR_DESCONTO,\n    VLR_MULTA,\n    FECHADO,\n    PESSOA_OBRIGATORIA,\n    TITULO_CRC_OBRIGATORIO,\n    TITULO_CPG_OBRIGATORIO,\n    CONTA_CORRENTE_OBRIGATORIA,\n    FILIAL_ORIGEM_OBRIGATORIA,\n    BEG_FIN_CONTA_CORRENTE_ID,\n    BEG_FIN_TIPO_DOCUMENTO_ID,\n    DOCUMENTO_OBRIGATORIO,\n    DOCUMENTO,\n    BEG_FIN_CC_MOVIMENTO_ID,\n    BEG_CPG_PGTO_MANUAL_ID,\n    LOTE_CPG_OBRIGATORIO,\n    DOCSTATUS,\n    BEG_FIN_CAIXA_SALDO_ID,\n    BEG_CHQ_CHEQUE_ID,\n    IND_CRC,\n    IND_CPG)\n  VALUES\n  (  BEG_FNC_AD_SEQUENCE('BEG_FIN_CAIXA_MOVIMENTO'),\n    :NEW.BEG_VW_FIN_CAIXA_ORIGEM_ID,\n    :NEW.AD_CLIENT_ID,\n    :NEW.AD_ORG_ID,\n    'Y',\n    SYSDATE,\n    :NEW.CREATEDBY,\n    SYSDATE,\n    :NEW.UPDATEdBY,\n    'A',\n    'D',\n    null,\n    BEG_FNC_RETORNA_PARAMETRO(:NEW.AD_CLIENT_ID, :NEW.AD_ORG_ID,'Financeiro','Caixa','TRANSFERENCIA_CHEQUE_SAIDA') ,\n    2000132,\n    NULL,\n    NULL,\n    null,\n    NULL,\n    :new.data_realizada,\n    :new.data_prevista,\n    v_cheques_remetidos.valor,\n    0,\n    0,\n    0,\n    0,\n    'N',\n    'N',\n    'N',\n    'N',\n    'N',\n    'N',\n    NULL,\n    NULL,\n    NULL,\n    null,\n    NULL,\n    NULL,\n    'N',\n    NULL,\n    v_saldo_origem_id,\n    v_cheques_remetidos.beg_chq_cheque_id,\n    null,\n    null\n  );\n    if :new.beg_fin_caixa_id is not null then\n    INSERT INTO BEG_FIN_CAIXA_MOVIMENTO\n  ( BEG_FIN_CAIXA_MOVIMENTO_ID,\n    BEG_FIN_CAIXA_ID,\n    AD_CLIENT_ID,\n    AD_ORG_ID,\n    ISACTIVE,\n    CREATED,\n    CREATEDBY,\n    UPDATED,\n    UPDATEDBY,\n    TP_LANCTO,\n    TP_MOVTO,\n    BEG_PESSOA_ID,\n    BEG_FIN_CAIXA_HISTORICO_ID,\n    BEG_FIN_CAIXA_CONTA_ID,\n    BEG_FILIAL_ID,\n    HISTORICO,\n    BEG_CRC_TITULO_ID,\n    BEG_CPG_TITULO_ID,\n    DATA_PREVISTA,\n    DATA_REALIZADA,\n    VLR_MOVIMENTO,\n    VLR_BAIXA,\n    VLR_JUROS,\n    VLR_DESCONTO,\n    VLR_MULTA,\n    FECHADO,\n    PESSOA_OBRIGATORIA,\n    TITULO_CRC_OBRIGATORIO,\n    TITULO_CPG_OBRIGATORIO,\n    CONTA_CORRENTE_OBRIGATORIA,\n    FILIAL_ORIGEM_OBRIGATORIA,\n    BEG_FIN_CONTA_CORRENTE_ID,\n    BEG_FIN_TIPO_DOCUMENTO_ID,\n    DOCUMENTO_OBRIGATORIO,\n    DOCUMENTO,\n    BEG_FIN_CC_MOVIMENTO_ID,\n    BEG_CPG_PGTO_MANUAL_ID,\n    LOTE_CPG_OBRIGATORIO,\n    DOCSTATUS,\n    BEG_FIN_CAIXA_SALDO_ID,\n    BEG_CHQ_CHEQUE_ID,\n    IND_CRC,\n    IND_CPG)\n  VALUES\n  (   BEG_FNC_AD_SEQUENCE('BEG_FIN_CAIXA_MOVIMENTO'),\n    :NEW.BEG_FIN_CAIXA_ID,\n    :NEW.AD_CLIENT_ID,\n    :NEW.AD_ORG_ID,\n    'Y',\n    SYSDATE,\n    :NEW.CREATEDBY,\n    SYSDATE,\n    :NEW.UPDATEdBY,\n    'A',\n    'S',\n    NULL,\n    BEG_FNC_RETORNA_PARAMETRO(:NEW.AD_CLIENT_ID, :NEW.AD_ORG_ID,'Financeiro','Caixa','TRANSFERENCIA_CHEQUE_ENTRADA') ,\n    2000132,\n    NULL,\n    NULL,\n    null,\n    NULL,\n    :new.data_realizada,\n    :new.data_prevista,\n    v_cheques_remetidos.valor,\n    0,\n    0,\n    0,\n    0,\n    'N',\n    'N',\n    'N',\n    'N',\n    'N',\n    'N',\n    NULL,\n    NULL,\n    NULL,\n    null,\n    NULL,\n    NULL,\n    'N',\n    NULL,\n    v_saldo_id,\n    v_cheques_remetidos.beg_chq_cheque_id,\n    null,\n    null\n  );\n    END IF;\n    IF :NEW.beg_fin_conta_corrente_id IS NOT NULL THEN \n      INSERT INTO BEG_FIN_BCO_MOVTO\n              ( BEG_FIN_BCO_MOVTO_ID,\n                AD_CLIENT_ID,\n                AD_ORG_ID,\n                ISACTIVE,\n                CREATED,\n                CREATEDBY,\n                UPDATED,\n                UPDATEDBY,\n                VALUE,\n                BEG_BANCO_ID,\n                BEG_AGENCIA_ID,\n                BEG_FIN_CONTA_CORRENTE_ID,\n                TIPO_LANCTO,\n                VERB_CODIGO,\n                TIPO_MOV,\n                DATA_LANC,\n                DATA_COMP,\n                VALOR,\n                HISTORICO,\n                BEG_FIN_BCO_CONTA_ID,\n                BEG_VW_FILIAL_ID,\n                BEG_CHQ_CHEQUE_ID,\n                BEG_CPG_PGTO_MANUAL_ID,\n                DATA_IDENTIFICACAO,\n                BEG_VW_FIN_BCO_CONTA_ID,\n                DT_INTEGRACAO,\n                IND_INTEGRADO,\n                IND_ESTORNO,\n                BEG_FIN_BCO_SALDO_ID,\n                NR_DEPOSITO,\n                IND_IDENTIFICACAO,\n                VLR_ORIGEM\n              )\n              VALUES\n              (\n                beg_fnc_ad_sequence('BEG_FIN_BCO_MOVTO'),\n                :NEW.AD_CLIENT_ID,\n                :NEW.AD_ORG_ID,\n                'Y',\n                SYSDATE,\n                :NEW.CREATEDBY,\n                SYSDATE,\n                :NEW.UPDATEDBY,\n                NULL,\n                V_CONTA.BEG_BANCO_ID,\n                V_CONTA.BEG_AGENCIA_ID,\n                :NEW.BEG_FIN_CONTA_CORRENTE_ID,\n                'E',\n                NULL,\n                'E',\n                :NEW.data_realizada,\n                :NEW.data_realizada,\n                v_cheques_remetidos.valor,\n                'CHEQUE TRANSFERIDO ',\n                1000010, --  CONTA DO BANCO\n                NULL,\n                v_cheques_remetidos.beg_chq_cheque_id,\n                NULL,\n                NULL,\n                NULL,\n                null,\n                'N',\n                'N',\n                V_SALDO_BCO_ID,\n                NULL,\n                null,\n                null\n              );\n\n    end if;\n    END LOOP;\n    CLOSE BUSCA_CHEQUES;\n  END IF;\nEND;\n"}`;
    
    }
}
